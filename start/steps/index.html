<!DOCTYPE html>
<html lang="en-us">
<head>
<meta charset="utf-8">
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>Getting Started - Localsite Setup</title>
<link rel="shortcut icon" href="data:image/x-icon;," type="image/x-icon">
<meta name="viewport" content="width=device-width, initial-scale=1">

<link type="text/css" href="../../css/base.css" rel="stylesheet" id="/localsite/css/base.css" />
<script type="text/javascript" src="../../js/localsite.js?showheader=true"></script>

<script>
// About localStorage
// https://blog.logrocket.com/localstorage-javascript-complete-guide/
function updateGitCmds() {
    // Get the value of the git account input field
    var gitAccount = document.getElementById("gitAccount").value;
    localStorage.gitAccount = gitAccount ;
    if (gitAccount == "") { 
      gitAccount = "[YOUR GITHUB ACCOUNT]";
    }
    // For these checkbox IDs
    var checkboxIds = ["localsiteForked", "ioForked", "data-pipelineForked", "communityForked", "appsForked"];

    // Loop through each checkbox
    let lineIndex = 0;
    let checkForks = [];
    checkboxIds.forEach(function(checkboxId) {
        var checkbox = document.getElementById(checkboxId);
        let repoName = checkboxId.replace("Forked","");
        let branch = "main";
        var updatedLine = "git clone https://github.com/modelearth/" + repoName + " " + repoName + " &&";
        //var updatedLineRefresh = "git pull https://github.com/modelearth/" + repoName + " " + branch + " &&";
        var updatedLineRefresh = "git pull https://github.com/modelearth/" + repoName + " &&";
        if (checkbox.checked) {
            // If checkbox is checked, construct the updated line
            updatedLine = "git clone https://github.com/" + gitAccount + "/" + repoName + " " + repoName + " &&";
            //updatedLineRefresh = "git pull https://github.com/" + gitAccount + "/" + repoName + " " + branch + " &&";
            updatedLineRefresh = "git pull https://github.com/" + gitAccount + "/" + repoName + " &&";
            checkForks.push(checkboxId);
        }
        // Get the current values of the textareas
        var currentCmd = document.getElementById("cloneCmd").value;
        var refreshCmd = document.getElementById("refreshCmd").value;

        // Split the textarea value by lines
        var linesClone = currentCmd.split("\n");
        var linesRefresh = refreshCmd.split("\n");

        // Replace the third line with the updated line
        linesClone[lineIndex] = updatedLine;

        linesRefresh[(lineIndex*2)+1] = updatedLineRefresh;

        // Join the lines back together and update the textareas
        let updatedCmd = linesClone.join("\n");
        document.getElementById("cloneCmd").value = updatedCmd;
        let refreshedCmd = linesRefresh.join("\n");
        document.getElementById("refreshCmd").value = refreshedCmd;

        // Save changes to the checkboxes
        localStorage.gitsForked = JSON.stringify(checkForks);
        lineIndex++;
    });
}


waitForElm('#gitAccount').then((elm) => {
  
  // Create and append copy icon
  var copyIcon = document.createElement("span");
  copyIcon.innerHTML = "&#x1F4CB;"; // Unicode for clipboard icon
  copyIcon.style.position = "absolute";
  copyIcon.style.bottom = "5px";
  copyIcon.style.right = "5px";
  copyIcon.style.cursor = "pointer";
  copyIcon.title = "Copy to Clipboard";
  document.getElementById("cloneCmd").parentNode.appendChild(copyIcon);

  // Add click event listener to copy icon
  copyIcon.addEventListener("click", function() {
    var textarea = document.getElementById("cloneCmd");
    textarea.select();
    document.execCommand("copy");
    alert("Text copied to clipboard!");
  });
  let hash = getHash();
  if (hash.git) {
    document.getElementById("gitAccount").value = hash.git;
  } else if (typeof localStorage.gitAccount != 'undefined') {
    document.getElementById("gitAccount").value = localStorage.gitAccount;
  }
  if (localStorage.gitsForked) {
    checkForks = JSON.parse(localStorage.gitsForked);
    checkForks.forEach(function(checkboxId) {
      var checkbox = document.getElementById(checkboxId);
      if (checkbox) {
          // If checkbox exists, check it
          checkbox.checked = true;
      }
    });
  }
  updateGitCmds(); // Insert GitHub name into cmds
});
</script>

<style>
</style>
</head>

<body>

<div class="content contentpadding" style="padding-top:50px;">
  <div id="readmeDiv"></div>
</div>

<script>
  loadMarkdown("README.md", "readmeDiv", "_parent");
</script>

</body>
</html>